{"ast":null,"code":"var _jsxFileName = \"/Users/sreedharperim/Aditi/Sem-5/Classroom/gclass_fullstack_final_v5_full/frontend/src/pages/MessageDetail.js\",\n  _s = $RefreshSig$();\n// frontend/src/pages/MessageDetail.js\nimport React, { useEffect, useState } from 'react';\nimport { useParams, Link, useNavigate } from 'react-router-dom';\nimport API from '../api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function MessageDetail() {\n  _s();\n  const {\n    id\n  } = useParams();\n  const navigate = useNavigate();\n  const [msg, setMsg] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    let mounted = true;\n    async function load() {\n      setLoading(true);\n      try {\n        // Backend: GET /api/messages/my returns list; we have no single-message endpoint in current backend,\n        // so fetch my messages and pick the one matching id. If you prefer, add GET /api/messages/:id backend route.\n        const res = await API.get('/messages/my');\n        const found = (res.data || []).find(m => String(m.id) === String(id));\n        if (!found) {\n          setError('Message not found');\n        } else if (mounted) {\n          setMsg(found);\n          // Mark read if unread\n          if (!found.read_at) {\n            try {\n              await API.post(`/messages/${found.id}/read`);\n              found.read_at = new Date().toISOString();\n            } catch (err) {/* ignore */}\n          }\n        }\n      } catch (err) {\n        var _err$response, _err$response$data;\n        setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || err.message);\n      } finally {\n        if (mounted) setLoading(false);\n      }\n    }\n    load();\n    return () => {\n      mounted = false;\n    };\n  }, [id]);\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"center-container\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      children: \"Loading message\\u2026\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 57\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 42,\n    columnNumber: 23\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"center-container\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      style: {\n        color: '#DC2626'\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 55\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 21\n  }, this);\n  if (!msg) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"center-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        marginBottom: 12\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        style: {\n          margin: 0\n        },\n        children: \"Message\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: \"/messages\",\n          className: \"btn btn-ghost\",\n          style: {\n            textDecoration: 'none',\n            marginRight: 8\n          },\n          children: \"\\u2190 Back\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => navigate(`/class/${msg.class_id}`),\n          className: \"btn btn-ghost\",\n          children: \"Go to class\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontWeight: 700,\n          fontSize: 18\n        },\n        children: msg.subject || '(No subject)'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"small-muted\",\n        style: {\n          marginBottom: 12\n        },\n        children: [\"From: \", msg.sender_name || 'Unknown', \" \\u2014 \", new Date(msg.created_at).toLocaleString()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          whiteSpace: 'pre-wrap'\n        },\n        children: msg.body\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"small-muted\",\n          children: [\"Targets: \", msg.has_targets ? 'Specific' : 'Entire class']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: 8\n          },\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => navigate('/messages'),\n            className: \"btn btn-ghost\",\n            children: \"Back to messages\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 5\n  }, this);\n}\n_s(MessageDetail, \"IiLUrBweEsuhn+MQ1bZ0qjOjWkM=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = MessageDetail;\nvar _c;\n$RefreshReg$(_c, \"MessageDetail\");","map":{"version":3,"names":["React","useEffect","useState","useParams","Link","useNavigate","API","jsxDEV","_jsxDEV","MessageDetail","_s","id","navigate","msg","setMsg","loading","setLoading","error","setError","mounted","load","res","get","found","data","find","m","String","read_at","post","Date","toISOString","err","_err$response","_err$response$data","response","message","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","color","display","justifyContent","alignItems","marginBottom","margin","to","textDecoration","marginRight","onClick","class_id","fontWeight","fontSize","subject","sender_name","created_at","toLocaleString","whiteSpace","body","marginTop","has_targets","_c","$RefreshReg$"],"sources":["/Users/sreedharperim/Aditi/Sem-5/Classroom/gclass_fullstack_final_v5_full/frontend/src/pages/MessageDetail.js"],"sourcesContent":["// frontend/src/pages/MessageDetail.js\nimport React, { useEffect, useState } from 'react';\nimport { useParams, Link, useNavigate } from 'react-router-dom';\nimport API from '../api';\n\nexport default function MessageDetail() {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [msg, setMsg] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    let mounted = true;\n    async function load() {\n      setLoading(true);\n      try {\n        // Backend: GET /api/messages/my returns list; we have no single-message endpoint in current backend,\n        // so fetch my messages and pick the one matching id. If you prefer, add GET /api/messages/:id backend route.\n        const res = await API.get('/messages/my');\n        const found = (res.data || []).find(m => String(m.id) === String(id));\n        if (!found) {\n          setError('Message not found');\n        } else if (mounted) {\n          setMsg(found);\n          // Mark read if unread\n          if (!found.read_at) {\n            try { await API.post(`/messages/${found.id}/read`); found.read_at = new Date().toISOString(); }\n            catch (err) { /* ignore */ }\n          }\n        }\n      } catch (err) {\n        setError(err.response?.data?.error || err.message);\n      } finally {\n        if (mounted) setLoading(false);\n      }\n    }\n    load();\n    return () => { mounted = false; };\n  }, [id]);\n\n  if (loading) return <div className=\"center-container\"><div className=\"card\">Loading message…</div></div>;\n  if (error) return <div className=\"center-container\"><div className=\"card\" style={{ color: '#DC2626' }}>{error}</div></div>;\n  if (!msg) return null;\n\n  return (\n    <div className=\"center-container\">\n      <div style={{ display:'flex', justifyContent:'space-between', alignItems:'center', marginBottom:12 }}>\n        <h1 style={{ margin: 0 }}>Message</h1>\n        <div>\n          <Link to=\"/messages\" className=\"btn btn-ghost\" style={{ textDecoration:'none', marginRight:8 }}>← Back</Link>\n          <button onClick={() => navigate(`/class/${msg.class_id}`)} className=\"btn btn-ghost\">Go to class</button>\n        </div>\n      </div>\n\n      <div className=\"card\">\n        <div style={{ fontWeight:700, fontSize:18 }}>{msg.subject || '(No subject)'}</div>\n        <div className=\"small-muted\" style={{ marginBottom: 12 }}>\n          From: {msg.sender_name || 'Unknown'} — {new Date(msg.created_at).toLocaleString()}\n        </div>\n        <div style={{ whiteSpace:'pre-wrap' }}>{msg.body}</div>\n        <div style={{ marginTop: 12 }}>\n          <div className=\"small-muted\">Targets: {msg.has_targets ? 'Specific' : 'Entire class'}</div>\n          <div style={{ marginTop: 8 }}>\n            <button onClick={() => navigate('/messages')} className=\"btn btn-ghost\">Back to messages</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}